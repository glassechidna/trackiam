{
  "Arn": "arn:aws:iam::aws:policy/service-role/AWSBackupServiceRolePolicyForBackup",
  "CreateDate": "2019-01-10T21:01:28Z",
  "DefaultVersionId": "v16",
  "IsAttachable": true,
  "Path": "/service-role/",
  "PolicyId": "ANPAIOOYZSLZZXWFJJ5N2",
  "PolicyName": "AWSBackupServiceRolePolicyForBackup",
  "PolicyVersion": {
    "CreateDate": "2023-09-06T20:38:44Z",
    "Document": {
      "Statement": [
        {
          "Action": "kms:CreateGrant",
          "Condition": {
            "Bool": {
              "kms:GrantIsForAWSResource": "true"
            }
          },
          "Effect": "Allow",
          "Resource": "*"
        },
        {
          "Action": [
            "ec2:ModifyImageAttribute",
            "ec2:ModifySnapshotAttribute"
          ],
          "Condition": {
            "Null": {
              "aws:ResourceTag/aws:backup:source-resource": "false"
            }
          },
          "Effect": "Allow",
          "Resource": "*"
        },
        {
          "Action": [
            "kms:Decrypt",
            "kms:GenerateDataKey"
          ],
          "Condition": {
            "StringLike": {
              "kms:ViaService": [
                "dynamodb.*.amazonaws.com"
              ]
            }
          },
          "Effect": "Allow",
          "Resource": "*"
        },
        {
          "Action": [
            "kms:GenerateDataKeyWithoutPlaintext"
          ],
          "Condition": {
            "StringLike": {
              "kms:ViaService": [
                "ec2.*.amazonaws.com"
              ]
            }
          },
          "Effect": "Allow",
          "Resource": "arn:aws:kms:*:*:key/*"
        },
        {
          "Action": "fsx:CreateBackup",
          "Effect": "Allow",
          "Resource": [
            "arn:aws:fsx:*:*:backup/*",
            "arn:aws:fsx:*:*:file-system/*",
            "arn:aws:fsx:*:*:volume/*"
          ]
        },
        {
          "Action": "fsx:DeleteBackup",
          "Effect": "Allow",
          "Resource": "arn:aws:fsx:*:*:backup/*"
        },
        {
          "Action": "fsx:DescribeBackups",
          "Effect": "Allow",
          "Resource": "arn:aws:fsx:*:*:backup/*"
        },
        {
          "Action": "fsx:DescribeFileSystems",
          "Effect": "Allow",
          "Resource": "arn:aws:fsx:*:*:file-system/*"
        },
        {
          "Action": "fsx:DescribeVolumes",
          "Effect": "Allow",
          "Resource": "arn:aws:fsx:*:*:volume/*"
        },
        {
          "Action": "fsx:ListTagsForResource",
          "Effect": "Allow",
          "Resource": [
            "arn:aws:fsx:*:*:file-system/*",
            "arn:aws:fsx:*:*:volume/*"
          ]
        },
        {
          "Action": "kms:DescribeKey",
          "Effect": "Allow",
          "Resource": "*"
        },
        {
          "Action": "ssm:SendCommand",
          "Effect": "Allow",
          "Resource": [
            "arn:aws:ec2:*:*:instance/*",
            "arn:aws:ssm:*:*:document/AWSEC2-CreateVssSnapshot"
          ]
        },
        {
          "Action": [
            "backup:CopyFromBackupVault"
          ],
          "Effect": "Allow",
          "Resource": "*"
        },
        {
          "Action": [
            "backup:CopyIntoBackupVault",
            "backup:DescribeBackupVault"
          ],
          "Effect": "Allow",
          "Resource": "arn:aws:backup:*:*:backup-vault:*"
        },
        {
          "Action": [
            "cloudformation:DescribeStacks",
            "cloudformation:GetTemplate",
            "cloudformation:ListStackResources",
            "cloudformation:ListStacks"
          ],
          "Effect": "Allow",
          "Resource": "arn:aws:cloudformation:*:*:stack/*/*"
        },
        {
          "Action": [
            "dynamodb:CreateBackup",
            "dynamodb:DescribeTable"
          ],
          "Effect": "Allow",
          "Resource": "arn:aws:dynamodb:*:*:table/*"
        },
        {
          "Action": [
            "dynamodb:DeleteBackup",
            "dynamodb:DescribeBackup"
          ],
          "Effect": "Allow",
          "Resource": "arn:aws:dynamodb:*:*:table/*/backup/*"
        },
        {
          "Action": [
            "ec2:CopyImage"
          ],
          "Effect": "Allow",
          "Resource": "*"
        },
        {
          "Action": [
            "ec2:CopySnapshot"
          ],
          "Effect": "Allow",
          "Resource": "arn:aws:ec2:*::snapshot/*"
        },
        {
          "Action": [
            "ec2:CreateImage",
            "ec2:DeregisterImage"
          ],
          "Effect": "Allow",
          "Resource": "*"
        },
        {
          "Action": [
            "ec2:CreateSnapshot",
            "ec2:DeleteSnapshot",
            "ec2:DescribeSnapshots",
            "ec2:DescribeVolumes"
          ],
          "Effect": "Allow",
          "Resource": [
            "arn:aws:ec2:*:*:volume/*",
            "arn:aws:ec2:*::snapshot/*"
          ]
        },
        {
          "Action": [
            "ec2:CreateTags"
          ],
          "Effect": "Allow",
          "Resource": "arn:aws:ec2:*:*:image/*"
        },
        {
          "Action": [
            "ec2:CreateTags",
            "ec2:DeleteSnapshot"
          ],
          "Effect": "Allow",
          "Resource": "arn:aws:ec2:*::snapshot/*"
        },
        {
          "Action": [
            "ec2:DescribeElasticGpus",
            "ec2:DescribeImages",
            "ec2:DescribeInstanceAttribute",
            "ec2:DescribeInstanceCreditSpecifications",
            "ec2:DescribeInstances",
            "ec2:DescribeNetworkInterfaces",
            "ec2:DescribeSnapshots",
            "ec2:DescribeSpotInstanceRequests",
            "ec2:DescribeTags"
          ],
          "Effect": "Allow",
          "Resource": "*"
        },
        {
          "Action": [
            "elasticfilesystem:Backup",
            "elasticfilesystem:DescribeTags"
          ],
          "Effect": "Allow",
          "Resource": "arn:aws:elasticfilesystem:*:*:file-system/*"
        },
        {
          "Action": [
            "fsx:CopyBackup",
            "fsx:ListTagsForResource",
            "fsx:ManageBackupPrincipalAssociations",
            "fsx:TagResource"
          ],
          "Effect": "Allow",
          "Resource": "arn:aws:fsx:*:*:backup/*"
        },
        {
          "Action": [
            "rds:AddTagsToResource",
            "rds:CopyDBClusterSnapshot",
            "rds:CopyDBSnapshot",
            "rds:CreateDBClusterSnapshot",
            "rds:CreateDBSnapshot",
            "rds:DescribeDBClusterAutomatedBackups",
            "rds:DescribeDBClusterSnapshots",
            "rds:DescribeDBClusters",
            "rds:DescribeDBInstances",
            "rds:DescribeDBSnapshots",
            "rds:ListTagsForResource"
          ],
          "Effect": "Allow",
          "Resource": "*"
        },
        {
          "Action": [
            "rds:DeleteDBClusterAutomatedBackup"
          ],
          "Effect": "Allow",
          "Resource": "arn:aws:rds:*:*:cluster-auto-backup:*"
        },
        {
          "Action": [
            "rds:DeleteDBClusterSnapshot",
            "rds:ModifyDBClusterSnapshotAttribute"
          ],
          "Effect": "Allow",
          "Resource": [
            "arn:aws:rds:*:*:cluster-snapshot:awsbackup:*"
          ]
        },
        {
          "Action": [
            "rds:DeleteDBSnapshot",
            "rds:ModifyDBSnapshotAttribute"
          ],
          "Effect": "Allow",
          "Resource": [
            "arn:aws:rds:*:*:snapshot:awsbackup:*"
          ]
        },
        {
          "Action": [
            "rds:ModifyDBCluster"
          ],
          "Effect": "Allow",
          "Resource": [
            "arn:aws:rds:*:*:cluster:*"
          ]
        },
        {
          "Action": [
            "rds:ModifyDBInstance"
          ],
          "Effect": "Allow",
          "Resource": [
            "arn:aws:rds:*:*:db:*"
          ]
        },
        {
          "Action": [
            "redshift:CreateClusterSnapshot",
            "redshift:DescribeClusterSnapshots",
            "redshift:DescribeTags"
          ],
          "Effect": "Allow",
          "Resource": [
            "arn:aws:redshift:*:*:cluster:*",
            "arn:aws:redshift:*:*:snapshot:*/*"
          ]
        },
        {
          "Action": [
            "redshift:CreateTags"
          ],
          "Effect": "Allow",
          "Resource": [
            "arn:aws:redshift:*:*:snapshot:*/*"
          ]
        },
        {
          "Action": [
            "redshift:DeleteClusterSnapshot"
          ],
          "Effect": "Allow",
          "Resource": [
            "arn:aws:redshift:*:*:snapshot:*/*"
          ]
        },
        {
          "Action": [
            "redshift:DescribeClusters"
          ],
          "Effect": "Allow",
          "Resource": [
            "arn:aws:redshift:*:*:cluster:*"
          ]
        },
        {
          "Action": [
            "ssm-sap:BackupDatabase",
            "ssm-sap:GetDatabase",
            "ssm-sap:ListTagsForResource",
            "ssm-sap:UpdateHanaBackupSettings"
          ],
          "Effect": "Allow",
          "Resource": "arn:aws:ssm-sap:*:*:*"
        },
        {
          "Action": [
            "ssm-sap:GetOperation",
            "ssm-sap:ListDatabases"
          ],
          "Effect": "Allow",
          "Resource": "*"
        },
        {
          "Action": [
            "ssm:CancelCommand",
            "ssm:GetCommandInvocation"
          ],
          "Effect": "Allow",
          "Resource": "*"
        },
        {
          "Action": [
            "storagegateway:CreateSnapshot",
            "storagegateway:ListTagsForResource"
          ],
          "Effect": "Allow",
          "Resource": "arn:aws:storagegateway:*:*:gateway/*/volume/*"
        },
        {
          "Action": [
            "tag:GetResources"
          ],
          "Effect": "Allow",
          "Resource": "*"
        },
        {
          "Action": [
            "timestream:DescribeDatabase",
            "timestream:DescribeTable",
            "timestream:GetAwsBackupStatus",
            "timestream:ListDatabases",
            "timestream:ListTables",
            "timestream:ListTagsForResource",
            "timestream:StartAwsBackupJob"
          ],
          "Effect": "Allow",
          "Resource": [
            "arn:aws:timestream:*:*:database/*"
          ]
        },
        {
          "Action": [
            "timestream:DescribeEndpoints"
          ],
          "Effect": "Allow",
          "Resource": "*"
        },
        {
          "Action": [
            "backup-gateway:Backup",
            "backup-gateway:ListTagsForResource"
          ],
          "Effect": "Allow",
          "Resource": "arn:aws:backup-gateway:*:*:vm/*",
          "Sid": "BackupGatewayBackupPermissions"
        },
        {
          "Action": [
            "dynamodb:ListTagsOfResource",
            "dynamodb:StartAwsBackupJob"
          ],
          "Effect": "Allow",
          "Resource": "arn:aws:dynamodb:*:*:table/*",
          "Sid": "DynamodbBackupPermissions"
        }
      ],
      "Version": "2012-10-17"
    },
    "IsDefaultVersion": true,
    "VersionId": "v16"
  },
  "UpdateDate": "2023-09-06T20:38:44Z"
}
