{
  "Arn": "arn:aws:iam::aws:policy/SageMakerStudioProjectUserRolePolicy",
  "CreateDate": "2024-11-20T21:59:23Z",
  "DefaultVersionId": "v62",
  "IsAttachable": true,
  "Path": "/",
  "PolicyId": "ANPAZKAPJZG4L52FJ276H",
  "PolicyName": "SageMakerStudioProjectUserRolePolicy",
  "PolicyVersion": {
    "CreateDate": "2026-02-16T18:42:14Z",
    "Document": {
      "Statement": [
        {
          "Action": "glue:*",
          "Condition": {
            "StringEquals": {
              "glue:LakeFormationPermissions": "Enabled"
            }
          },
          "Effect": "Allow",
          "NotResource": "arn:aws:glue:*:*:database/default",
          "Sid": "AllowAnyGlueCallIfPermissionManagedByLakeFormation"
        },
        {
          "Action": "*",
          "Condition": {
            "ForAnyValue:StringEquals": {
              "aws:TagKeys": [
                "AmazonDataZoneEnvironment",
                "AmazonDataZoneScopeName"
              ]
            }
          },
          "Effect": "Deny",
          "Resource": "*",
          "Sid": "DenyTaggingForManagedKey"
        },
        {
          "Action": "*",
          "Condition": {
            "ForAnyValue:StringEquals": {
              "aws:TagKeys": "AmazonDataZoneProject"
            },
            "Null": {
              "aws:RequestTag/AmazonDataZoneProject": "true"
            }
          },
          "Effect": "Deny",
          "Resource": "*",
          "Sid": "DenyUnTagForProjectKey"
        },
        {
          "Action": "*",
          "Condition": {
            "Null": {
              "aws:RequestTag/AmazonDataZoneProject": "false"
            },
            "StringNotEquals": {
              "aws:RequestTag/AmazonDataZoneProject": "${aws:PrincipalTag/AmazonDataZoneProject}"
            }
          },
          "Effect": "Deny",
          "Resource": "*",
          "Sid": "DenyIfRequestTagProjectMismatch"
        },
        {
          "Action": "bedrock:*",
          "Condition": {
            "StringEquals": {
              "aws:PrincipalTag/EnableAmazonBedrockPermissions": "false"
            }
          },
          "Effect": "Deny",
          "Resource": "*",
          "Sid": "SelectivePermissionDisablementForBedrock"
        },
        {
          "Action": "bedrock:CreateEvaluationJob",
          "Condition": {
            "StringEquals": {
              "aws:PrincipalTag/EnableAmazonBedrockPermissions": "true"
            }
          },
          "Effect": "Allow",
          "Resource": [
            "arn:aws:bedrock:*:*:custom-model/*",
            "arn:aws:bedrock:*::foundation-model/*"
          ],
          "Sid": "BedrockCreateEvaluationJobPermissions"
        },
        {
          "Action": "bedrock:InvokeInlineAgent",
          "Condition": {
            "StringEquals": {
              "aws:PrincipalTag/EnableAmazonBedrockIDEPermissions": "true",
              "bedrock:InlineAgentName": "${datazone:userId}"
            },
            "StringNotEquals": {
              "bedrock:InlineAgentName": ""
            }
          },
          "Effect": "Allow",
          "Resource": "*",
          "Sid": "InvokeBedrockInlineAgentPermissions"
        },
        {
          "Action": "bedrock:InvokeInlineAgent",
          "Condition": {
            "StringEquals": {
              "aws:PrincipalTag/EnableAmazonBedrockPermissions": "true",
              "bedrock:InlineAgentName": "${datazone:userId}"
            },
            "StringNotEquals": {
              "bedrock:InlineAgentName": ""
            }
          },
          "Effect": "Allow",
          "Resource": "*",
          "Sid": "BedrockInvokeInlineAgentPermissions"
        },
        {
          "Action": "bedrock:TagResource",
          "Condition": {
            "ForAllValues:StringLike": {
              "aws:TagKeys": [
                "AmazonBedrockManaged",
                "AmazonDataZone*",
                "ProjectUserTag*"
              ]
            },
            "StringEquals": {
              "aws:PrincipalTag/EnableAmazonBedrockIDEPermissions": "true",
              "aws:RequestTag/AmazonDataZoneProject": "${aws:PrincipalTag/AmazonDataZoneProject}",
              "aws:ResourceTag/AmazonDataZoneProject": "${aws:PrincipalTag/AmazonDataZoneProject}"
            }
          },
          "Effect": "Allow",
          "Resource": "*",
          "Sid": "TagBedrockResourcePermissions"
        },
        {
          "Action": "bedrock:TagResource",
          "Condition": {
            "ForAllValues:StringLike": {
              "aws:TagKeys": [
                "AmazonBedrockManaged",
                "AmazonDataZone*",
                "ProjectUserTag*"
              ]
            },
            "StringEquals": {
              "aws:PrincipalTag/EnableAmazonBedrockPermissions": "true",
              "aws:ResourceTag/AmazonDataZoneProject": "${aws:PrincipalTag/AmazonDataZoneProject}"
            },
            "StringEqualsIfExists": {
              "aws:RequestTag/AmazonDataZoneProject": "${aws:PrincipalTag/AmazonDataZoneProject}"
            }
          },
          "Effect": "Allow",
          "Resource": "arn:aws:bedrock:*:*:*",
          "Sid": "BedrockTagResourcePermissions"
        },
        {
          "Action": "ec2:DeleteNetworkInterface",
          "Condition": {
            "StringEqualsIfExists": {
              "ec2:Vpc": "${aws:PrincipalTag/vpcArn}"
            }
          },
          "Effect": "Allow",
          "Resource": "arn:aws:ec2:*:*:*/*",
          "Sid": "FederatedConnectionDeleteENIPermissions"
        },
        {
          "Action": "glue:*",
          "Condition": {
            "StringEquals": {
              "aws:PrincipalTag/EnableGlueWorkloadsPermissions": "false"
            }
          },
          "Effect": "Deny",
          "Resource": "*",
          "Sid": "SelectivePermissionDisablementForGlue"
        },
        {
          "Action": "iam:PassRole",
          "Condition": {
            "StringEquals": {
              "aws:PrincipalTag/EnableAmazonBedrockPermissions": "true",
              "iam:PassedToService": "bedrock.amazonaws.com"
            }
          },
          "Effect": "Allow",
          "Resource": [
            "arn:aws:iam::*:role/AmazonBedrockEvaluationRole-${aws:PrincipalTag/AmazonDataZoneProject}-*",
            "arn:aws:iam::*:role/AmazonBedrockServiceRole-${aws:PrincipalTag/AmazonDataZoneProject}-*"
          ],
          "Sid": "IamPassRoleToBedrockPermissions"
        },
        {
          "Action": "lambda:InvokeFunction",
          "Condition": {
            "StringEquals": {
              "aws:CalledViaFirst": "bedrock.amazonaws.com",
              "aws:PrincipalTag/EnableAmazonBedrockIDEPermissions": "true",
              "aws:ResourceTag/AmazonDataZoneProject": "${aws:PrincipalTag/AmazonDataZoneProject}"
            }
          },
          "Effect": "Allow",
          "Resource": "arn:aws:lambda:*:*:function:amazon-bedrock-ide-*",
          "Sid": "InvokeFunctionPermissionsForAmazonBedrockIDE"
        },
        {
          "Action": "lambda:InvokeFunction",
          "Condition": {
            "StringEquals": {
              "aws:CalledViaFirst": "bedrock.amazonaws.com",
              "aws:PrincipalTag/EnableAmazonBedrockPermissions": "true",
              "aws:ResourceTag/AmazonDataZoneProject": "${aws:PrincipalTag/AmazonDataZoneProject}"
            }
          },
          "Effect": "Allow",
          "Resource": "arn:aws:lambda:*:*:function:amazon-bedrock*",
          "Sid": "LambdaInvokeFunctionViaBedrockPermissions"
        },
        {
          "Action": "ram:AssociateResourceSharePermission",
          "Condition": {
            "ArnLike": {
              "ram:PermissionArn": "arn:aws:ram::aws:permission/AWSRAMLFEnabled*"
            },
            "ForAnyValue:StringEquals": {
              "aws:CalledVia": [
                "lakeformation.amazonaws.com"
              ]
            }
          },
          "Effect": "Allow",
          "Resource": "*",
          "Sid": "CrossAccountRAMResourceSharingViaLakeFormationHybrid"
        },
        {
          "Action": "s3:GetAccountPublicAccessBlock",
          "Condition": {
            "StringEquals": {
              "aws:ResourceAccount": "${aws:PrincipalAccount}"
            }
          },
          "Effect": "Allow",
          "Resource": "*",
          "Sid": "AirflowS3GetAccountPublicAccessBlock"
        },
        {
          "Action": "s3:GetBucketAcl",
          "Condition": {
            "StringEquals": {
              "aws:ResourceAccount": "${aws:PrincipalAccount}"
            }
          },
          "Effect": "Allow",
          "Resource": "arn:aws:s3:::${aws:PrincipalTag/DomainBucketName}",
          "Sid": "AccessLevelControlS3BucketPermissions"
        },
        {
          "Action": "s3:PutObjectTagging",
          "Condition": {
            "ForAllValues:StringEquals": {
              "s3:RequestObjectTagKeys": [
                "BasicValidationStatus",
                "ContainsReferenceResponseForAllPrompts"
              ]
            },
            "StringEquals": {
              "s3:RequestObjectTag/BasicValidationStatus": [
                "invalid",
                "valid"
              ],
              "s3:RequestObjectTag/ContainsReferenceResponseForAllPrompts": [
                "false",
                "true"
              ]
            },
            "StringNotEquals": {
              "aws:PrincipalTag/AmazonDataZoneDomain": "",
              "aws:PrincipalTag/AmazonDataZoneProject": "",
              "aws:PrincipalTag/DomainBucketName": ""
            }
          },
          "Effect": "Allow",
          "Resource": "arn:aws:s3:::${aws:PrincipalTag/DomainBucketName}/${aws:PrincipalTag/AmazonDataZoneDomain}/${aws:PrincipalTag/AmazonDataZoneProject}/genAI/assets/evaluations/*",
          "Sid": "TagS3ObjectPermissionsForBedrockEvaluation"
        },
        {
          "Action": "sts:SetContext",
          "Condition": {
            "ForAllValues:ArnEquals": {
              "sts:RequestContextProviders": [
                "arn:aws:iam::aws:contextProvider/IdentityCenter"
              ]
            },
            "Null": {
              "sts:RequestContextProviders": "false"
            }
          },
          "Effect": "Allow",
          "Resource": "*",
          "Sid": "StsContext"
        },
        {
          "Action": "sts:SetSourceIdentity",
          "Condition": {
            "StringLike": {
              "sts:SourceIdentity": "${aws:PrincipalTag/datazone:userId}"
            }
          },
          "Effect": "Allow",
          "Resource": "*",
          "Sid": "SetSourceIdentityForAssumeAccessRole"
        },
        {
          "Action": "sts:TagSession",
          "Condition": {
            "ForAllValues:StringEquals": {
              "aws:TagKeys": [
                "AmazonDataZoneDomain",
                "AmazonDataZoneProject"
              ]
            },
            "StringEquals": {
              "aws:RequestTag/AmazonDataZoneDomain": "${aws:PrincipalTag/AmazonDataZoneDomain}",
              "aws:RequestTag/AmazonDataZoneProject": "${aws:PrincipalTag/AmazonDataZoneProject}"
            }
          },
          "Effect": "Allow",
          "Resource": "*",
          "Sid": "TagSessionForAssumeAccessRole"
        },
        {
          "Action": [
            "airflow:GetEnvironment",
            "airflow:UpdateEnvironment"
          ],
          "Condition": {
            "StringEquals": {
              "aws:ResourceTag/AmazonDataZoneProject": "${aws:PrincipalTag/AmazonDataZoneProject}"
            }
          },
          "Effect": "Allow",
          "Resource": "*",
          "Sid": "AirflowActionsForTaggedEnvironments"
        },
        {
          "Action": [
            "airflow:ListTagsForResource",
            "athena:ListTagsForResource",
            "bedrock:ListTagsForResource",
            "dynamodb:ListTagsOfResource",
            "redshift-serverless:ListTagsForResource",
            "sqlworkbench:ListTagsForResource"
          ],
          "Condition": {
            "StringNotEquals": {
              "aws:ResourceTag/AmazonDataZoneProject": "${aws:PrincipalTag/AmazonDataZoneProject}",
              "aws:ResourceTag/for-use-with-all-datazone-projects": "true"
            }
          },
          "Effect": "Deny",
          "Resource": "*",
          "Sid": "DenyListTagValuesOnNonProject"
        },
        {
          "Action": [
            "athena:*",
            "codecommit:*",
            "ecr:*",
            "emr-serverless:*",
            "glue:*",
            "scheduler:*"
          ],
          "Condition": {
            "StringEquals": {
              "aws:ResourceTag/AmazonDataZoneProject": "${aws:PrincipalTag/AmazonDataZoneProject}"
            }
          },
          "Effect": "Allow",
          "Resource": "*",
          "Sid": "ProjectPermissions"
        },
        {
          "Action": [
            "athena:DeleteWorkGroup",
            "athena:UpdateWorkGroup",
            "codecommit:DeleteRepository",
            "codecommit:UpdateRepository",
            "codecommit:UpdateRepositoryEncryptionKey",
            "ecr:Delete*",
            "ecr:Put*",
            "ecr:Update*",
            "emr-serverless:Delete*",
            "emr-serverless:Put*",
            "emr-serverless:Update*",
            "glue:BatchDeleteConnection",
            "glue:DeleteConnection",
            "glue:UpdateConnection",
            "scheduler:DeleteScheduleGroup"
          ],
          "Condition": {
            "Null": {
              "aws:ResourceTag/AmazonDataZoneEnvironment": "false"
            }
          },
          "Effect": "Deny",
          "Resource": "*",
          "Sid": "DenyChangeOfDataZoneBlueprintResources"
        },
        {
          "Action": [
            "bedrock:ApplyGuardrail",
            "bedrock:BatchDeleteEvaluationJob",
            "bedrock:CreateAgentAlias",
            "bedrock:CreateBlueprint",
            "bedrock:CreateBlueprintVersion",
            "bedrock:CreateDataAutomationProject",
            "bedrock:CreateEvaluationJob",
            "bedrock:CreatePrompt",
            "bedrock:CreatePromptVersion",
            "bedrock:DeleteAgentAlias",
            "bedrock:DeleteAgentVersion",
            "bedrock:DeleteBlueprint",
            "bedrock:DeleteDataAutomationProject",
            "bedrock:DeletePrompt",
            "bedrock:GetAgentAlias",
            "bedrock:GetAgentVersion",
            "bedrock:GetBlueprint",
            "bedrock:GetDataAutomationProject",
            "bedrock:GetDataAutomationStatus",
            "bedrock:GetEvaluationJob",
            "bedrock:GetIngestionJob",
            "bedrock:GetPrompt",
            "bedrock:InvokeAgent",
            "bedrock:InvokeDataAutomationAsync",
            "bedrock:InvokeFlow",
            "bedrock:ListAgentActionGroups",
            "bedrock:ListAgentAliases",
            "bedrock:ListAgentKnowledgeBases",
            "bedrock:ListAgentVersions",
            "bedrock:ListIngestionJobs",
            "bedrock:ListPrompts",
            "bedrock:ListTagsForResource",
            "bedrock:Retrieve",
            "bedrock:StartIngestionJob",
            "bedrock:StopEvaluationJob",
            "bedrock:UpdateAgentAlias",
            "bedrock:UpdateBlueprint",
            "bedrock:UpdateDataAutomationProject"
          ],
          "Condition": {
            "StringEquals": {
              "aws:PrincipalTag/EnableAmazonBedrockPermissions": "true",
              "aws:ResourceTag/AmazonDataZoneProject": "${aws:PrincipalTag/AmazonDataZoneProject}"
            }
          },
          "Effect": "Allow",
          "Resource": "arn:aws:bedrock:*:*:*",
          "Sid": "BedrockResourceAccessPermissions"
        },
        {
          "Action": [
            "bedrock:ApplyGuardrail",
            "bedrock:BatchDeleteEvaluationJob",
            "bedrock:CreateAgentAlias",
            "bedrock:CreateEvaluationJob",
            "bedrock:CreatePrompt",
            "bedrock:CreatePromptVersion",
            "bedrock:DeleteAgentAlias",
            "bedrock:DeleteAgentVersion",
            "bedrock:DeletePrompt",
            "bedrock:GetAgentAlias",
            "bedrock:GetAgentVersion",
            "bedrock:GetEvaluationJob",
            "bedrock:GetIngestionJob",
            "bedrock:GetPrompt",
            "bedrock:InvokeAgent",
            "bedrock:InvokeFlow",
            "bedrock:ListAgentAliases",
            "bedrock:ListAgentVersions",
            "bedrock:ListIngestionJobs",
            "bedrock:ListPrompts",
            "bedrock:ListTagsForResource",
            "bedrock:Retrieve",
            "bedrock:StartIngestionJob",
            "bedrock:StopEvaluationJob",
            "bedrock:UpdateAgentAlias"
          ],
          "Condition": {
            "StringEquals": {
              "aws:PrincipalTag/EnableAmazonBedrockIDEPermissions": "true",
              "aws:ResourceTag/AmazonDataZoneProject": "${aws:PrincipalTag/AmazonDataZoneProject}"
            }
          },
          "Effect": "Allow",
          "Resource": "*",
          "Sid": "AccessBedrockResourcePermissions"
        },
        {
          "Action": [
            "bedrock:GetInferenceProfile",
            "bedrock:InvokeModel",
            "bedrock:InvokeModelWithResponseStream"
          ],
          "Condition": {
            "StringEquals": {
              "aws:PrincipalTag/EnableAmazonBedrockIDEPermissions": "true",
              "aws:ResourceTag/AmazonDataZoneProject": "${aws:PrincipalTag/AmazonDataZoneProject}"
            }
          },
          "Effect": "Allow",
          "Resource": "arn:aws:bedrock:*:*:application-inference-profile/*",
          "Sid": "InvokeBedrockModelAppInferenceProfilePermissions"
        },
        {
          "Action": [
            "bedrock:GetInferenceProfile",
            "bedrock:InvokeModel",
            "bedrock:InvokeModelWithResponseStream"
          ],
          "Condition": {
            "StringEquals": {
              "aws:PrincipalTag/EnableAmazonBedrockPermissions": "true",
              "aws:ResourceTag/AmazonDataZoneProject": "${aws:PrincipalTag/AmazonDataZoneProject}"
            }
          },
          "Effect": "Allow",
          "Resource": "arn:aws:bedrock:*:*:application-inference-profile/*",
          "Sid": "BedrockInvokeModelAppInferenceProfilePermissions"
        },
        {
          "Action": [
            "bedrock:InvokeDataAutomationAsync"
          ],
          "Condition": {
            "StringEquals": {
              "aws:PrincipalTag/EnableAmazonBedrockPermissions": "true"
            }
          },
          "Effect": "Allow",
          "Resource": [
            "arn:aws:bedrock:*:*:data-automation-profile/*"
          ],
          "Sid": "InvokeDataAutomationAsyncPermissions"
        },
        {
          "Action": [
            "bedrock:InvokeModel",
            "bedrock:InvokeModelWithResponseStream"
          ],
          "Condition": {
            "ArnLike": {
              "bedrock:InferenceProfileArn": "arn:aws:bedrock:*:*:application-inference-profile/*"
            },
            "StringEquals": {
              "aws:PrincipalTag/EnableAmazonBedrockPermissions": "true"
            }
          },
          "Effect": "Allow",
          "Resource": [
            "arn:aws:bedrock:*:*:custom-model/*",
            "arn:aws:bedrock:*:*:provisioned-model/*",
            "arn:aws:bedrock:*::foundation-model/*"
          ],
          "Sid": "BedrockInvokeModelPermissions"
        },
        {
          "Action": [
            "bedrock:InvokeModel",
            "bedrock:InvokeModelWithResponseStream"
          ],
          "Condition": {
            "Null": {
              "bedrock:InferenceProfileArn": "false"
            },
            "StringEquals": {
              "aws:PrincipalTag/EnableAmazonBedrockIDEPermissions": "true"
            }
          },
          "Effect": "Allow",
          "Resource": [
            "arn:aws:bedrock:*:*:custom-model/*",
            "arn:aws:bedrock:*:*:provisioned-model/*",
            "arn:aws:bedrock:*::foundation-model/*"
          ],
          "Sid": "InvokeBedrockModel"
        },
        {
          "Action": [
            "cloudformation:DescribeStacks",
            "cloudformation:GetTemplate"
          ],
          "Condition": {
            "StringEquals": {
              "aws:PrincipalTag/EnableAmazonBedrockIDEPermissions": "true",
              "aws:ResourceTag/AmazonDataZoneProject": "${aws:PrincipalTag/AmazonDataZoneProject}"
            }
          },
          "Effect": "Allow",
          "Resource": "arn:aws:cloudformation:*:*:stack/DataZone-Env-*",
          "Sid": "GetDataZoneEnvironmentCloudFormationStackPermissions"
        },
        {
          "Action": [
            "cloudformation:DescribeStacks",
            "cloudformation:GetTemplate"
          ],
          "Condition": {
            "StringEquals": {
              "aws:PrincipalTag/EnableAmazonBedrockPermissions": "true",
              "aws:ResourceTag/AmazonDataZoneProject": "${aws:PrincipalTag/AmazonDataZoneProject}"
            }
          },
          "Effect": "Allow",
          "Resource": "arn:aws:cloudformation:*:*:stack/DataZone-Env-*",
          "Sid": "CloudFormationGetDataZoneEnvironmentStackPermissions"
        },
        {
          "Action": [
            "cloudwatch:PutMetricData"
          ],
          "Condition": {
            "StringLike": {
              "cloudwatch:namespace": "AmazonMWAA"
            }
          },
          "Effect": "Allow",
          "Resource": "*",
          "Sid": "AirflowCloudwatchActions"
        },
        {
          "Action": [
            "cloudwatch:PutMetricData"
          ],
          "Condition": {
            "StringLike": {
              "cloudwatch:namespace": [
                "AWS/Glue",
                "Glue"
              ]
            }
          },
          "Effect": "Allow",
          "Resource": "*",
          "Sid": "GlueJobCloudwatchPutMetricActions"
        },
        {
          "Action": [
            "ec2:AttachNetworkInterface"
          ],
          "Condition": {
            "StringEquals": {
              "glue:RoleAssumedBy": "glue.amazonaws.com"
            },
            "StringNotEquals": {
              "aws:ResourceAccount": "${aws:PrincipalAccount}"
            }
          },
          "Effect": "Allow",
          "Resource": "arn:aws:ec2:*:*:instance/*",
          "Sid": "AllowAttachGlueEniOnInstance"
        },
        {
          "Action": [
            "ec2:AttachNetworkInterface",
            "ec2:DeleteNetworkInterface"
          ],
          "Condition": {
            "Null": {
              "aws:ResourceTag/aws-glue-service-resource": "false"
            },
            "StringEquals": {
              "aws:ResourceAccount": "${aws:PrincipalAccount}",
              "glue:RoleAssumedBy": "glue.amazonaws.com"
            }
          },
          "Effect": "Allow",
          "Resource": "arn:aws:ec2:*:*:network-interface/*",
          "Sid": "AllowManageGlueEni"
        },
        {
          "Action": [
            "ec2:CreateNetworkInterface"
          ],
          "Condition": {
            "Null": {
              "aws:TagKeys": "true"
            },
            "StringEquals": {
              "glue:RoleAssumedBy": "glue.amazonaws.com"
            }
          },
          "Effect": "Allow",
          "Resource": "arn:aws:ec2:*:*:network-interface/*",
          "Sid": "AllowGlueCreateEni"
        },
        {
          "Action": [
            "ec2:CreateNetworkInterface"
          ],
          "Condition": {
            "StringEquals": {
              "aws:ResourceAccount": "${aws:PrincipalAccount}",
              "aws:ResourceTag/AmazonDataZoneProject": "${aws:PrincipalTag/AmazonDataZoneProject}",
              "glue:RoleAssumedBy": "glue.amazonaws.com"
            }
          },
          "Effect": "Allow",
          "Resource": "arn:aws:ec2:*:*:security-group/*",
          "Sid": "AllowGlueCreateEniOnSecurityGroup"
        },
        {
          "Action": [
            "ec2:CreateNetworkInterface"
          ],
          "Condition": {
            "StringEquals": {
              "glue:RoleAssumedBy": "glue.amazonaws.com"
            }
          },
          "Effect": "Allow",
          "Resource": "arn:aws:ec2:*:*:subnet/*",
          "Sid": "AllowGlueCreateEniOnSubnet"
        },
        {
          "Action": [
            "ec2:CreateNetworkInterface",
            "ec2:DescribeSubnets",
            "ec2:DetachNetworkInterface"
          ],
          "Condition": {
            "StringEquals": {
              "ec2:Vpc": "${aws:PrincipalTag/vpcArn}"
            }
          },
          "Effect": "Allow",
          "Resource": "*",
          "Sid": "FederatedConnectionEC2Permissions"
        },
        {
          "Action": [
            "ec2:CreateTags",
            "ec2:DeleteTags"
          ],
          "Condition": {
            "ForAllValues:StringLike": {
              "aws:TagKeys": [
                "aws-glue-*"
              ]
            },
            "Null": {
              "aws:TagKeys": "false"
            },
            "StringEquals": {
              "aws:ResourceAccount": "${aws:PrincipalAccount}",
              "glue:RoleAssumedBy": "glue.amazonaws.com"
            }
          },
          "Effect": "Allow",
          "Resource": [
            "arn:aws:ec2:*:*:network-interface/*"
          ],
          "Sid": "EC2TagsPermissionsForGlue"
        },
        {
          "Action": [
            "ec2:DescribeNetworkInterfaces"
          ],
          "Condition": {
            "StringEquals": {
              "glue:RoleAssumedBy": "glue.amazonaws.com"
            }
          },
          "Effect": "Allow",
          "Resource": "*",
          "Sid": "AllowDescribeGlueEni"
        },
        {
          "Action": [
            "elasticmapreduce:DescribeCluster",
            "elasticmapreduce:GetManagedScalingPolicy",
            "elasticmapreduce:GetOnClusterAppUIPresignedURL"
          ],
          "Condition": {
            "StringEquals": {
              "aws:ResourceTag/AmazonDataZoneProject": "${aws:PrincipalTag/AmazonDataZoneProject}"
            }
          },
          "Effect": "Allow",
          "Resource": "*",
          "Sid": "EMRClusterWithDataZoneTags"
        },
        {
          "Action": [
            "elasticmapreduce:GetClusterSessionCredentials"
          ],
          "Condition": {
            "ArnLike": {
              "elasticmapreduce:ExecutionRoleArn": "arn:aws:iam::*:role/${aws:PrincipalTag/RoleName}"
            },
            "StringEquals": {
              "aws:ResourceTag/AmazonDataZoneProject": "${aws:PrincipalTag/AmazonDataZoneProject}"
            }
          },
          "Effect": "Allow",
          "Resource": [
            "arn:aws:elasticmapreduce:*:*:cluster/*"
          ],
          "Sid": "EMRGetClusterSessionCredentials"
        },
        {
          "Action": [
            "elasticmapreduce:GetPersistentAppUIPresignedURL"
          ],
          "Condition": {
            "ArnLike": {
              "elasticmapreduce:ExecutionRoleArn": "arn:aws:iam::*:role/${aws:PrincipalTag/RoleName}"
            }
          },
          "Effect": "Allow",
          "Resource": "*",
          "Sid": "EMRPersistentAppUI"
        },
        {
          "Action": [
            "emr-containers:DescribeManagedEndpoint",
            "emr-containers:DescribeSecurityConfiguration",
            "emr-containers:DescribeVirtualCluster",
            "emr-containers:GetManagedEndpointSessionCredentials",
            "redshift-serverless:GetCredentials",
            "redshift:GetClusterCredentialsWithIAM"
          ],
          "Condition": {
            "StringEquals": {
              "aws:ResourceTag/AmazonDataZoneProject": "${aws:PrincipalTag/AmazonDataZoneProject}"
            }
          },
          "Effect": "Allow",
          "Resource": "*",
          "Sid": "RedshiftGetCredentials"
        },
        {
          "Action": [
            "glue:DeleteResourcePolicy",
            "glue:PutResourcePolicy"
          ],
          "Condition": {
            "ForAnyValue:StringEquals": {
              "aws:CalledVia": [
                "ram.amazonaws.com"
              ]
            }
          },
          "Effect": "Allow",
          "Resource": [
            "arn:aws:glue:*:*:catalog",
            "arn:aws:glue:*:*:catalog/*",
            "arn:aws:glue:*:*:database/*",
            "arn:aws:glue:*:*:table/*"
          ],
          "Sid": "CrossAccountRAMResourceSharingPermissions"
        },
        {
          "Action": [
            "iam:GetRole"
          ],
          "Condition": {
            "StringEquals": {
              "aws:ResourceAccount": "${aws:PrincipalAccount}"
            }
          },
          "Effect": "Allow",
          "Resource": "*",
          "Sid": "IAMGetRole"
        },
        {
          "Action": [
            "iam:PassRole"
          ],
          "Condition": {
            "StringEquals": {
              "aws:PrincipalTag/EnableAmazonBedrockIDEPermissions": "true",
              "iam:PassedToService": [
                "bedrock.amazonaws.com"
              ]
            }
          },
          "Effect": "Allow",
          "Resource": [
            "arn:aws:iam::*:role/AmazonBedrockEvaluationRole-${aws:PrincipalTag/AmazonDataZoneProject}-*",
            "arn:aws:iam::*:role/AmazonBedrockServiceRole-${aws:PrincipalTag/AmazonDataZoneProject}-*"
          ],
          "Sid": "PassRoleToBedrockEvaluation"
        },
        {
          "Action": [
            "iam:PassRole"
          ],
          "Condition": {
            "StringEquals": {
              "aws:ResourceAccount": "${aws:PrincipalAccount}",
              "iam:PassedToService": [
                "access-grants.s3.amazonaws.com",
                "airflow.amazonaws.com",
                "emr-serverless.amazonaws.com",
                "glue.amazonaws.com",
                "sagemaker.amazonaws.com",
                "scheduler.amazonaws.com"
              ]
            }
          },
          "Effect": "Allow",
          "Resource": "arn:aws:iam::*:role/${aws:PrincipalTag/RoleName}",
          "Sid": "AllowPassRoleOnProjectRoles"
        },
        {
          "Action": [
            "kms:CreateGrant",
            "kms:Decrypt",
            "kms:Encrypt",
            "kms:GenerateDataKey",
            "kms:GenerateDataKeyWithoutPlaintext"
          ],
          "Condition": {
            "Null": {
              "kms:EncryptionContextKeys": "false"
            },
            "StringLike": {
              "kms:ViaService": [
                "s3.*.amazonaws.com",
                "sagemaker.*.amazonaws.com",
                "sqs.*.amazonaws.com"
              ]
            },
            "StringNotEquals": {
              "aws:ResourceAccount": "${aws:PrincipalAccount}"
            }
          },
          "Effect": "Allow",
          "Resource": [
            "arn:aws:kms:*:*:key/*"
          ],
          "Sid": "AwsOwnedKmsKeyPermissions"
        },
        {
          "Action": [
            "kms:CreateGrant",
            "kms:Decrypt",
            "kms:Encrypt",
            "kms:GenerateDataKey",
            "kms:GenerateDataKeyWithoutPlaintext",
            "kms:ReEncryptFrom",
            "kms:ReEncryptTo"
          ],
          "Condition": {
            "Null": {
              "kms:EncryptionContextKeys": "false"
            },
            "StringEquals": {
              "aws:ResourceAccount": "${aws:PrincipalAccount}"
            },
            "StringLike": {
              "kms:ViaService": [
                "bedrock.*.amazonaws.com",
                "glue.*.amazonaws.com",
                "s3.*.amazonaws.com",
                "sagemaker.*.amazonaws.com",
                "scheduler.*.amazonaws.com",
                "secretsmanager.*.amazonaws.com",
                "sqs.*.amazonaws.com"
              ]
            }
          },
          "Effect": "Allow",
          "Resource": "arn:aws:kms:*:*:key/${aws:PrincipalTag/KmsKeyId}",
          "Sid": "KmsWithEncrypt"
        },
        {
          "Action": [
            "kms:CreateGrant",
            "kms:Decrypt",
            "kms:GenerateDataKey",
            "kms:GenerateDataKeyWithoutPlaintext",
            "kms:ReEncryptFrom",
            "kms:ReEncryptTo"
          ],
          "Condition": {
            "Null": {
              "kms:EncryptionContextKeys": "false"
            },
            "StringEquals": {
              "aws:ResourceAccount": "${aws:PrincipalAccount}"
            },
            "StringLike": {
              "kms:ViaService": [
                "emr-serverless.*.amazonaws.com",
                "redshift.*.amazonaws.com"
              ]
            }
          },
          "Effect": "Allow",
          "Resource": "arn:aws:kms:*:*:key/${aws:PrincipalTag/KmsKeyId}",
          "Sid": "KmsPermissions"
        },
        {
          "Action": [
            "kms:Decrypt"
          ],
          "Condition": {
            "ForAnyValue:StringEquals": {
              "kms:EncryptionContextKeys": "aws:s3:arn"
            },
            "StringLike": {
              "kms:ViaService": "s3.*.amazonaws.com"
            },
            "StringNotEquals": {
              "aws:ResourceAccount": "${aws:PrincipalAccount}"
            }
          },
          "Effect": "Allow",
          "Resource": "*",
          "Sid": "DataLakeCrossAccountDecryptKMSPermissions"
        },
        {
          "Action": [
            "kms:Decrypt"
          ],
          "Condition": {
            "Null": {
              "kms:EncryptionContext:aws:scheduler:schedule:arn": "false"
            }
          },
          "Effect": "Allow",
          "Resource": "arn:aws:kms:*:*:key/${aws:PrincipalTag/KmsKeyId}",
          "Sid": "EBDecrypt"
        },
        {
          "Action": [
            "kms:Decrypt",
            "kms:Encrypt",
            "kms:GenerateDataKey"
          ],
          "Condition": {
            "StringEquals": {
              "kms:EncryptionContext:glue_catalog_id": "${aws:PrincipalAccount}"
            },
            "StringLike": {
              "kms:ViaService": [
                "glue.*.amazonaws.com"
              ]
            }
          },
          "Effect": "Allow",
          "Resource": [
            "arn:aws:kms:*:*:key/${aws:PrincipalTag/DefaultGlueCatalogKmsKeyId}",
            "arn:aws:kms:*:*:key/${aws:PrincipalTag/KmsKeyId}"
          ],
          "Sid": "GlueKmsPermissions"
        },
        {
          "Action": [
            "kms:Decrypt",
            "kms:Encrypt",
            "kms:GenerateDataKey",
            "kms:GenerateDataKeyWithoutPlaintext",
            "kms:ReEncryptFrom",
            "kms:ReEncryptTo"
          ],
          "Condition": {
            "Null": {
              "kms:EncryptionContext:aws:codecommit:id": "false"
            },
            "StringEquals": {
              "aws:ResourceAccount": "${aws:PrincipalAccount}"
            },
            "StringLike": {
              "kms:ViaService": [
                "codecommit.*.amazonaws.com"
              ]
            }
          },
          "Effect": "Allow",
          "Resource": "arn:aws:kms:*:*:key/${aws:PrincipalTag/KmsKeyId}",
          "Sid": "CodeCommitKmsPermissions"
        },
        {
          "Action": [
            "kms:Decrypt",
            "kms:GenerateDataKey"
          ],
          "Condition": {
            "ArnLike": {
              "kms:EncryptionContext:SecretARN": "arn:aws:secretsmanager:*:*:secret:amazon-bedrock*"
            },
            "StringEquals": {
              "aws:PrincipalTag/EnableAmazonBedrockPermissions": "true",
              "aws:ResourceAccount": "${aws:PrincipalAccount}"
            },
            "StringLike": {
              "kms:ViaService": "secretsmanager.*.amazonaws.com"
            }
          },
          "Effect": "Allow",
          "Resource": "arn:aws:kms:*:*:key/${aws:PrincipalTag/KmsKeyId}",
          "Sid": "KmsViaSecretsManagerPermissionsForBedrock"
        },
        {
          "Action": [
            "kms:Decrypt",
            "kms:GenerateDataKey"
          ],
          "Condition": {
            "ArnLike": {
              "kms:EncryptionContext:SecretARN": "arn:aws:secretsmanager:*:*:secret:amazon-bedrock-ide/*"
            },
            "StringEquals": {
              "aws:PrincipalTag/EnableAmazonBedrockIDEPermissions": "true",
              "aws:ResourceAccount": "${aws:PrincipalAccount}"
            },
            "StringLike": {
              "kms:ViaService": "secretsmanager.*.amazonaws.com"
            }
          },
          "Effect": "Allow",
          "Resource": "arn:aws:kms:*:*:key/${aws:PrincipalTag/KmsKeyId}",
          "Sid": "AccessSecretKmsPermissionsForAmazonBedrockIDE"
        },
        {
          "Action": [
            "kms:Decrypt",
            "kms:GenerateDataKey"
          ],
          "Condition": {
            "ArnLike": {
              "kms:EncryptionContext:aws:s3:arn": [
                "arn:aws:s3:::${aws:PrincipalTag/DomainBucketName}",
                "arn:aws:s3:::${aws:PrincipalTag/DomainBucketName}/*"
              ]
            },
            "StringLike": {
              "kms:ViaService": "s3.*.amazonaws.com"
            }
          },
          "Effect": "Allow",
          "Resource": "arn:aws:kms:*:*:key/${aws:PrincipalTag/KmsKeyId}",
          "Sid": "AccessDomainS3BucketKmsPermissions"
        },
        {
          "Action": [
            "kms:Decrypt",
            "kms:GenerateDataKey"
          ],
          "Condition": {
            "ForAllValues:StringLike": {
              "kms:EncryptionContextKeys": [
                "aws:bedrock*:arn",
                "aws:bedrock:guardrail-id"
              ]
            },
            "StringEquals": {
              "aws:PrincipalTag/EnableAmazonBedrockPermissions": "true",
              "aws:ResourceAccount": "${aws:PrincipalAccount}"
            },
            "StringLike": {
              "kms:ViaService": "bedrock.*.amazonaws.com"
            }
          },
          "Effect": "Allow",
          "Resource": "arn:aws:kms:*:*:key/${aws:PrincipalTag/KmsKeyId}",
          "Sid": "KmsViaBedrockPermissions"
        },
        {
          "Action": [
            "kms:Decrypt",
            "kms:GenerateDataKey"
          ],
          "Condition": {
            "Null": {
              "kms:EncryptionContext:aws:bedrock:arn": "false"
            },
            "StringEquals": {
              "aws:PrincipalTag/EnableAmazonBedrockIDEPermissions": "true",
              "aws:ResourceAccount": "${aws:PrincipalAccount}"
            },
            "StringLike": {
              "kms:ViaService": "bedrock.*.amazonaws.com"
            }
          },
          "Effect": "Allow",
          "Resource": "arn:aws:kms:*:*:key/${aws:PrincipalTag/KmsKeyId}",
          "Sid": "BedrockKmsPermissions"
        },
        {
          "Action": [
            "kms:Decrypt",
            "kms:GenerateDataKey"
          ],
          "Condition": {
            "StringEquals": {
              "kms:EncryptionContext:aws:datazone:domainId": "${aws:PrincipalTag/AmazonDataZoneDomain}"
            },
            "StringLike": {
              "kms:ViaService": "datazone.*.amazonaws.com"
            }
          },
          "Effect": "Allow",
          "Resource": "arn:aws:kms:*:*:key/${aws:PrincipalTag/DomainKmsKeyId}",
          "Sid": "DZDomainKMSKeyXAcctPerm"
        },
        {
          "Action": [
            "kms:DescribeKey"
          ],
          "Condition": {
            "StringLike": {
              "kms:ViaService": [
                "sagemaker.*.amazonaws.com",
                "sqs.*.amazonaws.com"
              ]
            },
            "StringNotEquals": {
              "aws:ResourceAccount": "${aws:PrincipalAccount}"
            }
          },
          "Effect": "Allow",
          "Resource": [
            "arn:aws:kms:*:*:key/*"
          ],
          "Sid": "AwsOwnedKmsManagement"
        },
        {
          "Action": [
            "kms:DescribeKey",
            "kms:GetPublicKey",
            "kms:ListGrants"
          ],
          "Condition": {
            "StringLike": {
              "kms:ViaService": "s3.*.amazonaws.com"
            },
            "StringNotEquals": {
              "aws:ResourceAccount": "${aws:PrincipalAccount}"
            }
          },
          "Effect": "Allow",
          "Resource": "*",
          "Sid": "DataLakeCrossAccountKMSPermissions"
        },
        {
          "Action": [
            "kms:DescribeKey",
            "kms:ListGrants",
            "kms:RevokeGrant"
          ],
          "Condition": {
            "StringEquals": {
              "aws:ResourceAccount": "${aws:PrincipalAccount}"
            },
            "StringLike": {
              "kms:ViaService": [
                "codecommit.*.amazonaws.com",
                "emr-serverless.*.amazonaws.com",
                "redshift.*.amazonaws.com",
                "s3.*.amazonaws.com",
                "sagemaker.*.amazonaws.com",
                "scheduler.*.amazonaws.com",
                "sqs.*.amazonaws.com"
              ]
            }
          },
          "Effect": "Allow",
          "Resource": "arn:aws:kms:*:*:key/${aws:PrincipalTag/KmsKeyId}",
          "Sid": "KmsManagement"
        },
        {
          "Action": [
            "kms:ListAliases"
          ],
          "Condition": {
            "StringEquals": {
              "aws:ResourceAccount": "${aws:PrincipalAccount}"
            }
          },
          "Effect": "Allow",
          "Resource": "*",
          "Sid": "ListKMS"
        },
        {
          "Action": [
            "quicksight:CreateDataSet",
            "quicksight:TagResource"
          ],
          "Condition": {
            "ForAllValues:StringLike": {
              "aws:TagKeys": [
                "AmazonDataZone*"
              ]
            },
            "Null": {
              "aws:TagKeys": "false"
            },
            "StringEquals": {
              "aws:ResourceTag/AmazonDataZoneProject": "${aws:PrincipalTag/AmazonDataZoneProject}"
            },
            "StringEqualsIfExists": {
              "aws:RequestTag/AmazonDataZoneProject": "${aws:PrincipalTag/AmazonDataZoneProject}"
            }
          },
          "Effect": "Allow",
          "Resource": "arn:aws:quicksight:*:*:dataset/*",
          "Sid": "ManageCreateDataSetPermissions"
        },
        {
          "Action": [
            "quicksight:CreateFolderMembership"
          ],
          "Condition": {
            "StringEquals": {
              "aws:ResourceTag/AmazonDataZoneAssetsFolder": "true",
              "aws:ResourceTag/AmazonDataZoneProject": "${aws:PrincipalTag/AmazonDataZoneProject}"
            }
          },
          "Effect": "Allow",
          "Resource": "arn:aws:quicksight:*:*:folder/sagemaker-*-assets",
          "Sid": "CreateFolderMembership"
        },
        {
          "Action": [
            "quicksight:DescribeDataSource",
            "quicksight:DescribeFolder",
            "quicksight:DescribeFolderPermissions",
            "quicksight:ListFolderMembers"
          ],
          "Condition": {
            "StringEquals": {
              "aws:ResourceTag/AmazonDataZoneProject": "${aws:PrincipalTag/AmazonDataZoneProject}"
            }
          },
          "Effect": "Allow",
          "Resource": [
            "arn:aws:quicksight:*:*:datasource/*",
            "arn:aws:quicksight:*:*:folder/*"
          ],
          "Sid": "ManageQuickSightFolderAndDataSourceResources"
        },
        {
          "Action": [
            "quicksight:PassDataSource"
          ],
          "Condition": {
            "StringEquals": {
              "aws:ResourceTag/AmazonDataZoneProject": "${aws:PrincipalTag/AmazonDataZoneProject}"
            }
          },
          "Effect": "Allow",
          "Resource": "arn:aws:quicksight:*:*:datasource/*",
          "Sid": "ManagePassDataSourcePermissions"
        },
        {
          "Action": [
            "ram:AcceptResourceShareInvitation"
          ],
          "Condition": {
            "StringLike": {
              "ram:ResourceShareName": [
                "DataZoneS3AG*",
                "LakeFormation*"
              ]
            }
          },
          "Effect": "Allow",
          "Resource": "arn:aws:ram:*:*:resource-share-invitation/*",
          "Sid": "CrossAccountRAMResourceShareInvitationPermission"
        },
        {
          "Action": [
            "ram:AssociateResourceShare",
            "ram:DeleteResourceShare",
            "ram:DisassociateResourceShare",
            "ram:ListResourceSharePermissions",
            "ram:UpdateResourceShare"
          ],
          "Condition": {
            "ForAnyValue:StringEquals": {
              "aws:CalledVia": [
                "lakeformation.amazonaws.com"
              ]
            },
            "StringLike": {
              "ram:ResourceShareName": [
                "LakeFormation*"
              ]
            }
          },
          "Effect": "Allow",
          "Resource": "*",
          "Sid": "CrossAccountRAMResourceSharingViaLakeFormationPermissions"
        },
        {
          "Action": [
            "ram:CreateResourceShare"
          ],
          "Condition": {
            "ForAnyValue:StringEquals": {
              "aws:CalledVia": [
                "lakeformation.amazonaws.com"
              ]
            },
            "StringEqualsIfExists": {
              "ram:RequestedResourceType": [
                "glue:Catalog",
                "glue:Database",
                "glue:Table"
              ]
            }
          },
          "Effect": "Allow",
          "Resource": "*",
          "Sid": "CrossAccountLakeFormationResourceSharingPermissions"
        },
        {
          "Action": [
            "ram:GetResourceShares"
          ],
          "Condition": {
            "ForAnyValue:StringEquals": {
              "aws:CalledVia": [
                "lakeformation.amazonaws.com"
              ]
            }
          },
          "Effect": "Allow",
          "Resource": "*",
          "Sid": "RAMGetResourceSharesViaLakeFormation"
        },
        {
          "Action": [
            "redshift-data:BatchExecuteStatement",
            "redshift-data:CancelStatement",
            "redshift-data:DescribeStatement",
            "redshift-data:ExecuteStatement",
            "redshift-data:GetStagingBucketLocation",
            "redshift-data:GetStatementResult",
            "redshift-serverless:GetManagedWorkgroup"
          ],
          "Condition": {
            "StringLike": {
              "redshift-data:glue-catalog-arn": "arn:aws:glue:*:*:catalog/*"
            }
          },
          "Effect": "Allow",
          "Resource": "*",
          "Sid": "RedshiftDataActionsForManagedWorkgroup"
        },
        {
          "Action": [
            "redshift-data:BatchExecuteStatement",
            "redshift-data:DescribeTable",
            "redshift-data:ExecuteStatement",
            "redshift-data:List*",
            "redshift-serverless:Get*",
            "redshift:DescribeTags",
            "redshift:GetClusterCredentialsWithIAM",
            "secretsmanager:GetSecretValue"
          ],
          "Condition": {
            "Null": {
              "aws:ResourceTag/AmazonDataZoneEnvironment": "true"
            },
            "StringEquals": {
              "aws:ResourceTag/for-use-with-all-datazone-projects": "true"
            }
          },
          "Effect": "Allow",
          "Resource": "*",
          "Sid": "ShareYourOwnResourceAcrossAllProjects"
        },
        {
          "Action": [
            "redshift-data:BatchExecuteStatement",
            "redshift-data:DescribeTable",
            "redshift-data:ExecuteStatement",
            "redshift-data:ListDatabases",
            "redshift-data:ListSchemas",
            "redshift-data:ListTables"
          ],
          "Condition": {
            "StringEquals": {
              "aws:ResourceTag/AmazonDataZoneProject": "${aws:PrincipalTag/AmazonDataZoneProject}"
            }
          },
          "Effect": "Allow",
          "Resource": "*",
          "Sid": "RedshiftDataActionsForResources"
        },
        {
          "Action": [
            "redshift-data:CancelStatement",
            "redshift-data:DescribeStatement",
            "redshift-data:GetStatementResult",
            "redshift-data:ListStatements"
          ],
          "Condition": {
            "StringEquals": {
              "redshift-data:statement-owner-iam-userid": "${aws:userid}"
            }
          },
          "Effect": "Allow",
          "Resource": "*",
          "Sid": "RedshiftDataActionsIAMSessionRestriction"
        },
        {
          "Action": [
            "redshift-serverless:GetCredentials"
          ],
          "Condition": {
            "Bool": {
              "aws:ViaAWSService": "true"
            },
            "ForAnyValue:StringEquals": {
              "aws:CalledVia": [
                "redshift-data.amazonaws.com",
                "sqlworkbench.amazonaws.com"
              ]
            }
          },
          "Effect": "Allow",
          "Resource": "arn:aws:redshift-serverless:*:*:workgroup/*",
          "Sid": "RedshifServerlessCredentialsForManagedWorkgroup"
        },
        {
          "Action": [
            "redshift-serverless:GetNamespace",
            "redshift-serverless:GetWorkgroup",
            "redshift-serverless:ListTagsForResource",
            "redshift:DescribeTags"
          ],
          "Condition": {
            "StringEquals": {
              "aws:ResourceTag/AmazonDataZoneProject": "${aws:PrincipalTag/AmazonDataZoneProject}"
            }
          },
          "Effect": "Allow",
          "Resource": "*",
          "Sid": "RedshiftServerlessWorkgroupWithResourceType"
        },
        {
          "Action": [
            "redshift:GetClusterCredentialsWithIAM"
          ],
          "Condition": {
            "Bool": {
              "aws:ViaAWSService": "true"
            }
          },
          "Effect": "Allow",
          "Resource": "arn:aws:redshift:*:*:dbname:*/*",
          "Sid": "RedshiftExistingComputeConnectToCatalog"
        },
        {
          "Action": [
            "s3:*",
            "sqs:*",
            "ssm:*"
          ],
          "Condition": {
            "StringNotEquals": {
              "aws:ResourceAccount": "${aws:PrincipalAccount}"
            }
          },
          "Effect": "Allow",
          "Resource": "*",
          "Sid": "CrossAccountPermissions"
        },
        {
          "Action": [
            "s3:AbortMultipartUpload",
            "s3:DeleteObject*",
            "s3:GetObject*",
            "s3:ListMultipartUploadParts",
            "s3:PutObject*",
            "s3:ReplicateObject",
            "s3:RestoreObject"
          ],
          "Condition": {
            "StringEquals": {
              "aws:ResourceAccount": "${aws:PrincipalAccount}"
            },
            "StringNotEquals": {
              "aws:PrincipalTag/AmazonDataZoneDomain": "",
              "aws:PrincipalTag/AmazonDataZoneProject": "",
              "aws:PrincipalTag/DomainBucketName": ""
            }
          },
          "Effect": "Allow",
          "Resource": [
            "arn:aws:s3:::${aws:PrincipalTag/DomainBucketName}/${aws:PrincipalTag/AmazonDataZoneDomain}/${aws:PrincipalTag/AmazonDataZoneProject}/*"
          ],
          "Sid": "AccessDomainS3BucketPermissions"
        },
        {
          "Action": [
            "s3:GetBucketLocation"
          ],
          "Condition": {
            "StringEquals": {
              "aws:ResourceAccount": "${aws:PrincipalAccount}"
            }
          },
          "Effect": "Allow",
          "Resource": "*",
          "Sid": "DataLakeS3BucketActions"
        },
        {
          "Action": [
            "s3:GetBucketPublicAccessBlock",
            "s3:GetEncryptionConfiguration"
          ],
          "Condition": {
            "StringEquals": {
              "aws:ResourceAccount": "${aws:PrincipalAccount}"
            }
          },
          "Effect": "Allow",
          "Resource": "arn:aws:s3:::${aws:PrincipalTag/DomainBucketName}",
          "Sid": "AirflowS3BucketActions"
        },
        {
          "Action": [
            "s3:ListBucket"
          ],
          "Condition": {
            "ArnEquals": {
              "lambda:SourceFunctionArn": "arn:aws:lambda:*:*:function:athenafederatedcatalog_*"
            },
            "StringEquals": {
              "aws:ResourceAccount": "${aws:PrincipalAccount}"
            }
          },
          "Effect": "Allow",
          "Resource": [
            "arn:aws:s3:::${aws:PrincipalTag/DomainBucketName}"
          ],
          "Sid": "ListDomainBucketFromAthenaFederatedCatalog"
        },
        {
          "Action": [
            "s3:ListBucket"
          ],
          "Condition": {
            "StringEquals": {
              "aws:ResourceAccount": "${aws:PrincipalAccount}"
            },
            "StringNotEquals": {
              "aws:PrincipalTag/DomainBucketName": ""
            }
          },
          "Effect": "Allow",
          "Resource": "arn:aws:s3:::${aws:PrincipalTag/DomainBucketName}",
          "Sid": "AirflowListDomainS3BucketPermissions"
        },
        {
          "Action": [
            "s3:ListBucket",
            "s3:ListBucketVersions"
          ],
          "Condition": {
            "StringEquals": {
              "aws:ResourceAccount": "${aws:PrincipalAccount}"
            },
            "StringLike": {
              "s3:prefix": [
                "${aws:PrincipalTag/AmazonDataZoneDomain}/${aws:PrincipalTag/AmazonDataZoneProject}",
                "${aws:PrincipalTag/AmazonDataZoneDomain}/${aws:PrincipalTag/AmazonDataZoneProject}/*"
              ]
            },
            "StringNotEquals": {
              "aws:PrincipalTag/AmazonDataZoneDomain": "",
              "aws:PrincipalTag/AmazonDataZoneProject": "",
              "aws:PrincipalTag/DomainBucketName": ""
            }
          },
          "Effect": "Allow",
          "Resource": "arn:aws:s3:::${aws:PrincipalTag/DomainBucketName}",
          "Sid": "ListDomainS3BucketPermissions"
        },
        {
          "Action": [
            "secretsmanager:DescribeSecret",
            "secretsmanager:GetSecretValue"
          ],
          "Condition": {
            "StringEquals": {
              "aws:ResourceAccount": "${aws:PrincipalAccount}",
              "aws:ResourceTag/AmazonDataZoneProject": "${aws:PrincipalTag/AmazonDataZoneProject}",
              "glue:RoleAssumedBy": "glue.amazonaws.com"
            }
          },
          "Effect": "Allow",
          "Resource": "*",
          "Sid": "FederatedDataConnectionGlueSecret"
        },
        {
          "Action": [
            "secretsmanager:DescribeSecret",
            "secretsmanager:PutSecretValue"
          ],
          "Condition": {
            "StringEquals": {
              "aws:PrincipalTag/EnableAmazonBedrockIDEPermissions": "true",
              "aws:ResourceTag/AmazonDataZoneProject": "${aws:PrincipalTag/AmazonDataZoneProject}"
            }
          },
          "Effect": "Allow",
          "Resource": "arn:aws:secretsmanager:*:*:secret:amazon-bedrock-ide/*",
          "Sid": "AccessSecretPermissionsForAmazonBedrockIDE"
        },
        {
          "Action": [
            "secretsmanager:DescribeSecret",
            "secretsmanager:PutSecretValue"
          ],
          "Condition": {
            "StringEquals": {
              "aws:PrincipalTag/EnableAmazonBedrockPermissions": "true",
              "aws:ResourceTag/AmazonDataZoneProject": "${aws:PrincipalTag/AmazonDataZoneProject}"
            }
          },
          "Effect": "Allow",
          "Resource": "arn:aws:secretsmanager:*:*:secret:amazon-bedrock*",
          "Sid": "SecretsManagerPermissionsForBedrock"
        },
        {
          "Action": [
            "secretsmanager:GetSecretValue"
          ],
          "Condition": {
            "StringEquals": {
              "aws:ResourceAccount": "${aws:PrincipalAccount}",
              "aws:ResourceTag/AmazonDataZoneProject": "${aws:PrincipalTag/AmazonDataZoneProject}"
            }
          },
          "Effect": "Allow",
          "Resource": "arn:aws:secretsmanager:*:*:secret:*",
          "Sid": "AllowGetSecretForRedShift"
        },
        {
          "Action": [
            "secretsmanager:GetSecretValue"
          ],
          "Condition": {
            "StringEquals": {
              "aws:ResourceTag/for-use-with-all-datazone-projects": "true"
            }
          },
          "Effect": "Allow",
          "Resource": "arn:*:secretsmanager:*:*:secret:*",
          "Sid": "FederatedConnectionGetSecretPermissions"
        },
        {
          "Action": [
            "sqlworkbench:BatchGetNotebookCell",
            "sqlworkbench:CreateNotebook*",
            "sqlworkbench:DeleteNotebook*",
            "sqlworkbench:ExportNotebook",
            "sqlworkbench:GetNotebook",
            "sqlworkbench:TagResource",
            "sqlworkbench:UpdateNotebook*"
          ],
          "Condition": {
            "StringEquals": {
              "aws:ResourceTag/AmazonDataZoneProject": "${aws:PrincipalTag/AmazonDataZoneProject}",
              "aws:ResourceTag/sqlworkbench-resource-owner": "${aws:userid}"
            }
          },
          "Effect": "Allow",
          "Resource": "*",
          "Sid": "SQLWorkBenchNotebookActions"
        },
        {
          "Action": [
            "sso:DescribeApplication"
          ],
          "Condition": {
            "ForAnyValue:StringLike": {
              "aws:CalledVia": [
                "emr-containers.amazonaws.com"
              ]
            }
          },
          "Effect": "Allow",
          "Resource": "*",
          "Sid": "EmrContainersSSO"
        },
        {
          "Action": [
            "sts:AssumeRole"
          ],
          "Condition": {
            "StringNotEquals": {
              "aws:PrincipalTag/AmazonDataZoneProject": ""
            }
          },
          "Effect": "Allow",
          "Resource": "*",
          "Sid": "AllowAssumeAccessRole"
        },
        {
          "Action": [
            "sts:SetContext"
          ],
          "Condition": {
            "ForAnyValue:StringEquals": {
              "aws:CalledVia": [
                "sqlworkbench.amazonaws.com"
              ]
            }
          },
          "Effect": "Allow",
          "Resource": [
            "arn:aws:sts::*:self"
          ],
          "Sid": "SetContextForTrustedIdentityPropagation"
        },
        {
          "Action": "bedrock:CreateEvaluationJob",
          "Effect": "Allow",
          "Resource": [
            "arn:aws:bedrock:*:*:custom-model/*",
            "arn:aws:bedrock:*::foundation-model/*"
          ],
          "Sid": "CreateEvaluationJobForFoundationModelPermissions"
        },
        {
          "Action": "sqlworkbench:AssociateNotebookWithTab",
          "Effect": "Allow",
          "Resource": "arn:*:sqlworkbench:*:*:notebook/*",
          "Sid": "SQLWorkBenchActions"
        },
        {
          "Action": [
            "airflow:CreateWebLoginToken",
            "airflow:InvokeRestApi"
          ],
          "Effect": "Allow",
          "Resource": [
            "arn:aws:airflow:*:*:role/DataZoneMWAAEnv-${aws:PrincipalTag/AmazonDataZoneDomain}-${aws:PrincipalTag/AmazonDataZoneProject}-${aws:PrincipalTag/AmazonDataZoneScopeName}/User"
          ],
          "Sid": "AirflowUiApiAccess"
        },
        {
          "Action": [
            "airflow:List*",
            "athena:List*",
            "bedrock:List*",
            "dynamodb:List*",
            "elasticmapreduce:List*",
            "glue:List*",
            "redshift-serverless:List*",
            "secretsmanager:List*",
            "sqlworkbench:List*"
          ],
          "Effect": "Allow",
          "Resource": "*",
          "Sid": "AllowAccountDiscovery"
        },
        {
          "Action": [
            "athena:CreateWorkgroup",
            "codecommit:CreateRepository",
            "emr-serverless:CreateApplication",
            "glue:CreateConnection",
            "scheduler:CreateScheduleGroup"
          ],
          "Effect": "Deny",
          "Resource": "*",
          "Sid": "DenyCreateActionsOnBlueprintGovernedResources"
        },
        {
          "Action": [
            "athena:GetDataCatalog",
            "athena:GetDatabase",
            "athena:GetTableMetadata",
            "athena:ListDatabases",
            "athena:ListTableMetadata"
          ],
          "Effect": "Allow",
          "Resource": [
            "arn:aws:athena:*:*:datacatalog/AwsDataCatalog",
            "arn:aws:athena:*:*:datacatalog/awsdatacatalog"
          ],
          "Sid": "DefaultAthenaDataCatalogPermissions"
        },
        {
          "Action": [
            "bedrock:RetrieveAndGenerate",
            "codewhisperer:GenerateRecommendations",
            "glue:DescribeConnectionType",
            "glue:DescribeEntity",
            "glue:GetClassifier",
            "glue:GetClassifiers",
            "glue:GetCompletion",
            "glue:GetEntityRecords",
            "glue:GetGeneratedCode",
            "glue:GetUserDefinedFunction",
            "glue:GetUserDefinedFunctions",
            "glue:StartCompletion",
            "glue:UseGlueStudio",
            "iam:ListRoles",
            "logs:DescribeLogGroups",
            "logs:StopQuery",
            "pricing:GetProducts",
            "q:SendMessage",
            "q:StartConversation",
            "tag:GetResources"
          ],
          "Effect": "Allow",
          "Resource": "*",
          "Sid": "EnableAccountLevelFunctionality"
        },
        {
          "Action": [
            "cloudwatch:GetMetricData",
            "cloudwatch:GetMetricStatistics"
          ],
          "Effect": "Allow",
          "Resource": "*",
          "Sid": "CloudWatchMetricsPermissions"
        },
        {
          "Action": [
            "datazone:CreateConnection",
            "datazone:DeleteConnection",
            "datazone:GetConnection",
            "datazone:GetDomain",
            "datazone:GetDomainExecutionRoleCredentials",
            "datazone:GetEnvironment",
            "datazone:GetEnvironmentBlueprintConfiguration",
            "datazone:GetProject",
            "datazone:GetUserProfile",
            "datazone:ListConnections",
            "datazone:ListEnvironmentBlueprints",
            "datazone:ListEnvironments",
            "datazone:ListProjects",
            "datazone:PostLineageEvent",
            "datazone:UpdateConnection"
          ],
          "Effect": "Allow",
          "Resource": "arn:aws:datazone:*:*:domain/${aws:PrincipalTag/AmazonDataZoneDomain}",
          "Sid": "DataZoneUserPermissions"
        },
        {
          "Action": [
            "ec2:DescribeInstanceTypes"
          ],
          "Effect": "Allow",
          "Resource": "*",
          "Sid": "EC2PermissionsForNotebookExecution"
        },
        {
          "Action": [
            "ec2:DescribeNetworkInterfaces"
          ],
          "Effect": "Allow",
          "Resource": "*",
          "Sid": "FederatedConnectionDescribeENIPermissions"
        },
        {
          "Action": [
            "ec2:DescribeRouteTables",
            "ec2:DescribeSecurityGroups",
            "ec2:DescribeSubnets",
            "ec2:DescribeVpcEndpoints",
            "ec2:DescribeVpcs"
          ],
          "Effect": "Allow",
          "Resource": "*",
          "Sid": "GlueKernelPermissions"
        },
        {
          "Action": [
            "elasticmapreduce:CreatePersistentAppUI",
            "elasticmapreduce:DescribePersistentAppUI"
          ],
          "Effect": "Allow",
          "Resource": "*",
          "Sid": "EMRClusterInfoPermissions"
        },
        {
          "Action": [
            "glue:CreateDatabase",
            "glue:DeleteDatabase",
            "glue:GetDatabase"
          ],
          "Effect": "Allow",
          "Resource": [
            "arn:aws:glue:*:*:catalog",
            "arn:aws:glue:*:*:database/global_temp"
          ],
          "Sid": "GlueGlobalTempDatabasePermissions"
        },
        {
          "Action": [
            "glue:CreateDatabase",
            "glue:DeleteDatabase",
            "glue:GetDatabase"
          ],
          "Effect": "Allow",
          "Resource": [
            "arn:aws:glue:*:*:catalog/*",
            "arn:aws:glue:*:*:database/*"
          ],
          "Sid": "GlueCatalogDatabasePermissions"
        },
        {
          "Action": [
            "glue:GetConnection",
            "glue:GetConnections"
          ],
          "Effect": "Allow",
          "Resource": "arn:aws:glue:*:*:catalog",
          "Sid": "GlueGetConnectionOnlyOnCatalog"
        },
        {
          "Action": [
            "glue:GetDatabase"
          ],
          "Effect": "Allow",
          "Resource": [
            "arn:aws:glue:*:*:catalog",
            "arn:aws:glue:*:*:database/default"
          ],
          "Sid": "GlueGetDefaultDatabase"
        },
        {
          "Action": [
            "glue:GetDatabases"
          ],
          "Effect": "Allow",
          "Resource": "arn:aws:glue:*:*:catalog",
          "Sid": "GlueListDatabasesOnNoDatabases"
        },
        {
          "Action": [
            "lakeformation:BatchGrantPermissions",
            "lakeformation:BatchRevokePermissions",
            "lakeformation:CreateDataCellsFilter",
            "lakeformation:DeleteDataCellsFilter",
            "lakeformation:DescribeResource",
            "lakeformation:GetDataCellsFilter",
            "lakeformation:ListDataCellsFilter",
            "lakeformation:ListPermissions",
            "lakeformation:UpdateDataCellsFilter",
            "ram:GetResourceShareInvitations",
            "ram:ListResources"
          ],
          "Effect": "Allow",
          "Resource": "*",
          "Sid": "LakeformationResourceSharingPermissions"
        },
        {
          "Action": [
            "lakeformation:GetDataAccess",
            "lakeformation:GetResourceLFTags"
          ],
          "Effect": "Allow",
          "Resource": "*",
          "Sid": "LakeFormationPermissionForDataLakeAccess"
        },
        {
          "Action": [
            "logs:CreateLogGroup",
            "logs:CreateLogStream",
            "logs:DescribeLogStreams",
            "logs:FilterLogEvents",
            "logs:Get*",
            "logs:PutLogEvents",
            "logs:StartQuery"
          ],
          "Effect": "Allow",
          "Resource": [
            "arn:aws:logs:*:*:log-group:${aws:PrincipalTag/LogGroupName}*",
            "arn:aws:logs:*:*:log-group:${aws:PrincipalTag/LogGroupName}*:log-stream:*"
          ],
          "Sid": "ProjectLogGroupPermissions"
        },
        {
          "Action": [
            "logs:CreateLogGroup",
            "logs:CreateLogStream",
            "logs:GetLogEvents",
            "logs:GetLogGroupFields",
            "logs:GetLogRecord",
            "logs:GetQueryResults",
            "logs:PutLogEvents"
          ],
          "Effect": "Allow",
          "Resource": [
            "arn:aws:logs:*:*:log-group:airflow-DataZoneMWAAEnv-${aws:PrincipalTag/AmazonDataZoneDomain}-${aws:PrincipalTag/AmazonDataZoneProject}-${aws:PrincipalTag/AmazonDataZoneScopeName}-*"
          ],
          "Sid": "AirflowCloudwatchLogsActions"
        },
        {
          "Action": [
            "logs:CreateLogGroup",
            "logs:CreateLogStream",
            "logs:PutLogEvents"
          ],
          "Effect": "Allow",
          "Resource": "arn:aws:logs:*:*:log-group:/aws-glue/*",
          "Sid": "GlueJobRunnerSessionLogPermissions"
        },
        {
          "Action": [
            "logs:CreateLogGroup",
            "logs:CreateLogStream",
            "logs:PutLogEvents"
          ],
          "Effect": "Allow",
          "Resource": "arn:aws:logs:*:*:log-group:/aws/lambda/athenafederatedcatalog*",
          "Sid": "FederatedConnectionLambdaLogsPermissions"
        },
        {
          "Action": [
            "quicksight:DescribeAccountSubscription",
            "quicksight:DescribeDataSet",
            "quicksight:DescribeGroup",
            "quicksight:DescribeUser"
          ],
          "Effect": "Allow",
          "Resource": [
            "arn:aws:quicksight:*:*:*"
          ],
          "Sid": "ManageQuickSightOtherResources"
        },
        {
          "Action": [
            "redshift:DescribeClusters"
          ],
          "Effect": "Allow",
          "Resource": "*",
          "Sid": "RedshiftWithoutResourceType"
        },
        {
          "Action": [
            "sagemaker-unified-studio-mcp:CallPrivilegedTool",
            "sagemaker-unified-studio-mcp:CallReadOnlyTool",
            "sagemaker-unified-studio-mcp:InvokeMcp"
          ],
          "Effect": "Allow",
          "Resource": "*",
          "Sid": "SageMakerUnifiedStudioMcp"
        },
        {
          "Action": [
            "sqlworkbench:*QCustomContext",
            "sqlworkbench:CreateConnection",
            "sqlworkbench:DeleteTab",
            "sqlworkbench:DriverExecute",
            "sqlworkbench:GetAutocompletion*",
            "sqlworkbench:GetQSql*",
            "sqlworkbench:GetQueryExecutionHistory",
            "sqlworkbench:GetSchemaInference",
            "sqlworkbench:GetUserInfo",
            "sqlworkbench:PassAccountSettings",
            "sqlworkbench:PutTab"
          ],
          "Effect": "Allow",
          "Resource": "*",
          "Sid": "SQLWorkBenchActionsWithoutResourceType"
        }
      ],
      "Version": "2012-10-17"
    },
    "IsDefaultVersion": true,
    "VersionId": "v62"
  },
  "UpdateDate": "2026-02-16T18:42:14Z"
}
